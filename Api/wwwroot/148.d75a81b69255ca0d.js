"use strict";(self.webpackChunkClientApp=self.webpackChunkClientApp||[]).push([[148],{4148:(ee,f,a)=>{a.r(f),a.d(f,{AdminModule:()=>W});var l=a(6895),c=a(8184),e=a(1571),u=a(2340),T=a(529);let g=(()=>{var n;class o{constructor(t){this.http=t}getMembers(){return this.http.get(`${u.N.appUrl}admin/get-members`)}getMember(t){return this.http.get(`${u.N.appUrl}admin/get-member/${t}`)}getApplicationRoles(){return this.http.get(`${u.N.appUrl}admin/get-application-roles/`)}addEditMember(t){return this.http.post(`${u.N.appUrl}admin/add-edit-member`,t)}lockMember(t){return this.http.put(`${u.N.appUrl}admin/lock-member/${t}`,{})}unlockMember(t){return this.http.put(`${u.N.appUrl}admin/unlock-member/${t}`,{})}deleteMember(t){return this.http.delete(`${u.N.appUrl}admin/delete-member/${t}`,{})}}return(n=o).\u0275fac=function(t){return new(t||n)(e.LFG(T.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),o})();var b=a(5423),N=a(220);function M(n,o){1&n&&(e.TgZ(0,"tr")(1,"td",8),e._uU(2,"No Members"),e.qZA()())}function k(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function U(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,k,2,0,"span",5),e.qZA()),2&n){const r=o.$implicit,t=o.index,i=e.oxw().$implicit;e.xp6(1),e.hij(" ",r,""),e.xp6(1),e.Q6J("ngIf",t+1<i.roles.length)}}function C(n,o){if(1&n){const r=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(r);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.lockMember(i.id))}),e._uU(1," Lock "),e.qZA()}}function q(n,o){if(1&n){const r=e.EpF();e.TgZ(0,"a",14),e.NdJ("click",function(){e.CHM(r);const i=e.oxw().$implicit,s=e.oxw();return e.KtG(s.unlockMember(i.id))}),e._uU(1," Unlock "),e.qZA()}}function F(n,o){if(1&n){const r=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"titlecase"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.ALo(8,"titlecase"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e.YNc(13,U,3,2,"span",6),e.qZA(),e.TgZ(14,"td",4),e.YNc(15,C,2,0,"a",9),e.YNc(16,q,2,0,"a",10),e.qZA(),e.TgZ(17,"td",4)(18,"button",11),e._uU(19," Edit "),e.qZA(),e.TgZ(20,"button",12),e.NdJ("click",function(){const s=e.CHM(r).$implicit,d=e.oxw(),p=e.MAs(24);return e.KtG(d.deleteMember(s.id,p))}),e._uU(21," Delete "),e.qZA()()()}if(2&n){const r=o.$implicit;e.xp6(2),e.Oqu(r.userName),e.xp6(2),e.Oqu(e.lcZ(5,8,r.firstName)),e.xp6(3),e.Oqu(e.lcZ(8,10,r.lastName)),e.xp6(3),e.Oqu(e.lcZ(11,12,r.dateCreated)),e.xp6(3),e.Q6J("ngForOf",r.roles),e.xp6(2),e.Q6J("ngIf",!r.isLocked),e.xp6(1),e.Q6J("ngIf",r.isLocked),e.xp6(2),e.MGl("routerLink","/admin/add-edit-member/",r.id,"")}}function w(n,o){if(1&n){const r=e.EpF();e.TgZ(0,"div",15)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.confirm())}),e._uU(4," Yes "),e.qZA(),e.TgZ(5,"button",17),e.NdJ("click",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.decline())}),e._uU(6," No "),e.qZA()()}if(2&n){const r=e.oxw();e.xp6(2),e.hij("Are you sure you want to delete ",null==r.memberToDelete?null:r.memberToDelete.userName,"")}}let I=(()=>{var n;class o{constructor(t,i,s){this.adminService=t,this.sharedService=i,this.modalService=s,this.members=[]}ngOnInit(){this.adminService.getMembers().subscribe({next:t=>this.members=t})}lockMember(t){this.adminService.lockMember(t).subscribe({next:i=>{this.handleLockUnlockFilterMessage(t,!0)}})}unlockMember(t){this.adminService.unlockMember(t).subscribe({next:i=>{this.handleLockUnlockFilterMessage(t,!1)}})}deleteMember(t,i){let s=this.findMember(t);s&&(this.memberToDelete=s,this.modalRef=this.modalService.show(i,{class:"modal-sm"}))}confirm(){this.memberToDelete&&this.adminService.deleteMember(this.memberToDelete.id).subscribe({next:t=>{this.sharedService.showNotification(!0,"Deleted",`Member of ${this.memberToDelete?.userName} has been deleted!`),this.members=this.members.filter(i=>i.id!==this.memberToDelete?.id),this.memberToDelete=void 0,this.modalRef?.hide()}})}decline(){this.memberToDelete=void 0,this.modalRef?.hide()}handleLockUnlockFilterMessage(t,i){let s=this.findMember(t);s&&(s.isLocked=!s.isLocked,i?this.sharedService.showNotification(!0,"Locked",`${s.userName} member has been locked`):this.sharedService.showNotification(!0,"Unlocked",`${s.userName} member has been unlocked`))}findMember(t){let i=this.members.find(s=>s.id===t);if(i)return i}}return(n=o).\u0275fac=function(t){return new(t||n)(e.Y36(g),e.Y36(b.F),e.Y36(N.tT))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-admin"]],decls:25,vars:2,consts:[[1,"my-3"],["routerLink","/admin/add-edit-member",1,"btn","btn-outline-primary"],[1,"table","table-striped"],[1,"table-warning"],[1,"text-center"],[4,"ngIf"],[4,"ngFor","ngForOf"],["template",""],["colspan","7",1,"text-center"],["class","btn btn-warning btn-sm",3,"click",4,"ngIf"],["class","btn btn-success btn-sm",3,"click",4,"ngIf"],[1,"btn","btn-primary","btn-sm","me-2",3,"routerLink"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"btn","btn-success","btn-sm",3,"click"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"a",1),e._uU(2,"Create Member"),e.qZA()(),e.TgZ(3,"table",2)(4,"thead")(5,"tr",3)(6,"th"),e._uU(7,"Username"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"First name"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Last name"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Date created"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Roles"),e.qZA(),e.TgZ(16,"th",4),e._uU(17,"Lock / Unlock"),e.qZA(),e.TgZ(18,"th",4),e._uU(19,"Edit / Delete"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,M,3,0,"tr",5),e.YNc(22,F,22,14,"tr",6),e.qZA()(),e.YNc(23,w,7,1,"ng-template",null,7,e.W1O)),2&t&&(e.xp6(21),e.Q6J("ngIf",0===i.members.length),e.xp6(1),e.Q6J("ngForOf",i.members))},dependencies:[l.sg,l.O5,c.rH,l.rS,l.uU]}),o})();var y=a(4004),E=a(1816),J=a(9479);let L=(()=>{var n;class o{constructor(t,i,s){this.accountService=t,this.sharedService=i,this.router=s}canActivate(){return this.accountService.user$.pipe((0,y.U)(t=>!(!t||!(0,E.Z)(t.jwt).role.includes("Admin"))||(this.sharedService.showNotification(!1,"Admin Area","Leave now!"),this.router.navigateByUrl("/"),!1)))}}return(n=o).\u0275fac=function(t){return new(t||n)(e.LFG(J.B),e.LFG(b.F),e.LFG(c.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),o})();var m=a(433),Y=a(8860);function S(n,o){1&n&&(e.TgZ(0,"span",31),e._uU(1,"Add"),e.qZA())}function $(n,o){1&n&&(e.TgZ(0,"span",31),e._uU(1,"Update"),e.qZA())}function Q(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," First Name is required"),e.qZA())}function O(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Last Name is required"),e.qZA())}function R(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Username is required"),e.qZA())}function G(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Password is required"),e.qZA())}function j(n,o){1&n&&(e.TgZ(0,"span",32),e._uU(1," Password must be at least 6, and maximum 15 characters "),e.qZA())}function D(n,o){1&n&&(e.TgZ(0,"div")(1,"span",33),e._uU(2,"Note:"),e.qZA(),e._uU(3," If you don't istend to change the member password, then leave the password field empty "),e.qZA())}function z(n,o){if(1&n){const r=e.EpF();e.ynx(0),e.TgZ(1,"input",34),e.NdJ("change",function(){const s=e.CHM(r).$implicit,d=e.oxw(2);return e.KtG(d.roleOnChange(s))}),e.qZA(),e.TgZ(2,"label",35),e._uU(3),e.qZA(),e.BQk()}if(2&n){const r=o.$implicit,t=e.oxw(2);let i;e.xp6(1),e.ekj("is-invalid",t.submitted&&(null==(i=t.memberForm.get("roles"))?null:i.errors)),e.s9C("id",r),e.Q6J("checked",t.existingMemberRoles.includes(r)),e.xp6(1),e.s9C("for",r),e.xp6(1),e.Oqu(r)}}function B(n,o){1&n&&(e.TgZ(0,"div",32),e._uU(1," Please select at least one role "),e.qZA())}function H(n,o){if(1&n&&(e.TgZ(0,"div",36),e._UZ(1,"app-validation-messages",37),e.qZA()),2&n){const r=e.oxw(2);e.xp6(1),e.Q6J("errorMessages",r.errorMessages)}}function K(n,o){if(1&n){const r=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"main",3)(3,"form",4),e.NdJ("ngSubmit",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.submit())}),e.TgZ(4,"div",5)(5,"h3",6),e.YNc(6,S,2,0,"span",7),e.YNc(7,$,2,0,"span",7),e._uU(8," Member "),e.qZA()(),e.TgZ(9,"div",8),e._UZ(10,"input",9),e.TgZ(11,"label",10),e._uU(12,"First name"),e.qZA(),e.YNc(13,Q,2,0,"span",11),e.qZA(),e.TgZ(14,"div",8),e._UZ(15,"input",12),e.TgZ(16,"label",13),e._uU(17,"Last name"),e.qZA(),e.YNc(18,O,2,0,"span",11),e.qZA(),e.TgZ(19,"div",8),e._UZ(20,"input",14),e.TgZ(21,"label",15),e._uU(22,"Username"),e.qZA(),e.YNc(23,R,2,0,"span",11),e.qZA(),e.TgZ(24,"div",8)(25,"input",16),e.NdJ("change",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.passwordOnChange())}),e.qZA(),e.TgZ(26,"label",17),e._uU(27,"Password"),e.qZA(),e.YNc(28,G,2,0,"span",11),e.YNc(29,j,2,0,"span",11),e.YNc(30,D,4,0,"div",18),e.qZA(),e.TgZ(31,"div",19)(32,"div",20)(33,"label",21),e._uU(34,"Roles:"),e.qZA()(),e.TgZ(35,"div",22)(36,"div",23),e.YNc(37,z,4,6,"ng-container",24),e.qZA()()(),e.YNc(38,B,2,0,"div",11),e.YNc(39,H,2,1,"div",25),e.TgZ(40,"div",26)(41,"div",27)(42,"div",28)(43,"button",29),e._uU(44),e.qZA()()(),e.TgZ(45,"div",27)(46,"div",28)(47,"button",30),e._uU(48," Back to list "),e.qZA()()()()()()()()}if(2&n){const r=e.oxw();let t,i,s,d,p,A,v,x,_,Z;e.xp6(3),e.Q6J("formGroup",r.memberForm),e.xp6(3),e.Q6J("ngIf",r.addNew),e.xp6(1),e.Q6J("ngIf",!r.addNew),e.xp6(3),e.ekj("is-invalid",r.submitted&&(null==(t=r.memberForm.get("firstName"))?null:t.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(i=r.memberForm.get("firstName"))?null:i.hasError("required"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(s=r.memberForm.get("lastName"))?null:s.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(d=r.memberForm.get("lastName"))?null:d.hasError("required"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(p=r.memberForm.get("userName"))?null:p.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(A=r.memberForm.get("userName"))?null:A.hasError("required"))),e.xp6(2),e.ekj("is-invalid",r.submitted&&(null==(v=r.memberForm.get("password"))?null:v.errors)),e.xp6(3),e.Q6J("ngIf",r.submitted&&(null==(x=r.memberForm.get("password"))?null:x.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(_=r.memberForm.get("password"))?null:_.hasError("minlength"))||(null==(_=r.memberForm.get("password"))?null:_.hasError("maxlength"))),e.xp6(1),e.Q6J("ngIf",!r.addNew),e.xp6(7),e.Q6J("ngForOf",r.applicationRoles),e.xp6(1),e.Q6J("ngIf",r.submitted&&(null==(Z=r.memberForm.get("roles"))?null:Z.hasError("required"))),e.xp6(1),e.Q6J("ngIf",r.errorMessages.length>0),e.xp6(5),e.hij(" ",r.addNew?"Create":"Upadate"," Member ")}}let h=(()=>{var n;class o{constructor(t,i,s,d,p){this.adminService=t,this.sharedService=i,this.formBuilder=s,this.router=d,this.activatedRoute=p,this.memberForm=new m.cw({}),this.formInitialized=!1,this.addNew=!0,this.submitted=!1,this.errorMessages=[],this.applicationRoles=[],this.existingMemberRoles=[]}ngOnInit(){const t=this.activatedRoute.snapshot.paramMap.get("id");t?(this.addNew=!1,this.getMember(t)):this.initializeForm(void 0),this.getRoles()}getMember(t){this.adminService.getMember(t).subscribe({next:i=>{this.initializeForm(i)}})}getRoles(){this.adminService.getApplicationRoles().subscribe({next:t=>this.applicationRoles=t})}initializeForm(t){t?(this.memberForm=this.formBuilder.group({id:[t.id],firstName:[t.firstName,m.kI.required],lastName:[t.lastName,m.kI.required],userName:[t.userName,m.kI.required],password:[""],roles:[t.roles,m.kI.required]}),this.existingMemberRoles=t.roles.split(",")):this.memberForm=this.formBuilder.group({id:[""],firstName:["",m.kI.required],lastName:["",m.kI.required],userName:["",m.kI.required],password:["",[m.kI.required,m.kI.minLength(6),m.kI.maxLength(15)]],roles:["",m.kI.required]}),this.formInitialized=!0}passwordOnChange(){0==this.addNew&&(this.memberForm.get("password")?.value?this.memberForm.controls.password.setValidators([m.kI.required,m.kI.minLength(6),m.kI.maxLength(15)]):this.memberForm.get("password")?.clearValidators(),this.memberForm.controls.password.updateValueAndValidity())}roleOnChange(t){let i=this.memberForm.get("roles")?.value.split(",");const s=i.indexOf(t);-1!==s?i.splice(s,1):i.push(t),""===i[0]&&i.splice(0,1),this.memberForm.controls.roles.setValue(i.join(","))}submit(){this.submitted=!0,this.errorMessages=[],this.memberForm.valid&&this.adminService.addEditMember(this.memberForm.value).subscribe({next:t=>{this.sharedService.showNotification(!0,t.value.titile,t.value.message),this.router.navigateByUrl("/admin")},error:t=>{t.error.errors?this.errorMessages=t.error.errors:this.errorMessages.push(t.error)}})}}return(n=o).\u0275fac=function(t){return new(t||n)(e.Y36(g),e.Y36(b.F),e.Y36(m.qu),e.Y36(c.F0),e.Y36(c.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-edit-member"]],decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"col-12","col-lg-5"],[1,"form-signin"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],[1,"mb-3","font-weight-normal"],["class","text-warning",4,"ngIf"],[1,"form-floating","mb-3"],["formControlName","firstName","type","text","placeholder","First Name",1,"form-control"],["for","firstName"],["class","text-danger",4,"ngIf"],["formControlName","lastName","type","text","placeholder","Last Name",1,"form-control"],["for","lastName"],["formControlName","userName","type","text","placeholder","Username",1,"form-control"],["for","userName"],["formControlName","password","type","text","placeholder","Password",1,"form-control",3,"change"],["for","password"],[4,"ngIf"],[1,"row"],[1,"col-2"],["for","roles"],[1,"col-10"],[1,"btn-group"],[4,"ngFor","ngForOf"],["class","form-floatin",4,"ngIf"],[1,"row","my-4"],[1,"col-6"],[1,"d-grid"],["type","submit",1,"btn","btn-block","btn-info"],["type","button","routerLink","/admin",1,"btn","btn-block","btn-danger"],[1,"text-warning"],[1,"text-danger"],[1,"text-info","fw-bold"],["type","checkbox",1,"btn-check",3,"id","checked","change"],[1,"btn","btn-outline-primary",3,"for"],[1,"form-floatin"],[3,"errorMessages"]],template:function(t,i){1&t&&e.YNc(0,K,49,21,"div",0),2&t&&e.Q6J("ngIf",i.formInitialized)},dependencies:[l.sg,l.O5,c.rH,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u,Y.s]}),o})();const P=[{path:"",runGuardsAndResolvers:"always",canActivate:[L],children:[{path:"",component:I},{path:"add-edit-member",component:h},{path:"add-edit-member/:id",component:h}]}];let V=(()=>{var n;class o{}return(n=o).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.Bz.forChild(P),c.Bz]}),o})();var X=a(4466);let W=(()=>{var n;class o{}return(n=o).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[l.ez,V,X.m]}),o})()}}]);